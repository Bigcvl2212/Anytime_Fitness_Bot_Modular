{% extends "base.html" %}

{% block title %}{{ member.full_name }} - Member Details{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="text-purple">
                <i class="fas fa-user me-2"></i>
                {{ member.full_name }}
                <span class="badge badge-purple ms-3">Member ID: {{ member.id }}</span>
            </h1>
            <a href="/members" class="btn btn-outline-purple">
                <i class="fas fa-arrow-left me-2"></i>Back to Members
            </a>
        </div>
    </div>
</div>

<!-- Quick Stats -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card">
            <div class="card-body text-center">
                <i class="fas fa-id-card fa-2x text-purple mb-2"></i>
                <h5>Member Status</h5>
                <span class="badge bg-success">{{ member.status or 'Active' }}</span>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card">
            <div class="card-body text-center">
                <i class="fas fa-calendar fa-2x text-purple mb-2"></i>
                <h5>Join Date</h5>
                <p class="mb-0">{{ member.join_date or 'N/A' }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card">
            <div class="card-body text-center">
                <i class="fas fa-credit-card fa-2x text-purple mb-2"></i>
                <h5>Payment Type</h5>
                <p class="mb-0">{{ member.card_type or 'N/A' }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card">
            <div class="card-body text-center">
                <i class="fas fa-home fa-2x text-purple mb-2"></i>
                <h5>Home Club</h5>
                <p class="mb-0">{{ member.home_club_name or 'N/A' }}</p>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- Contact Information -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header bg-purple text-white">
                <h5 class="mb-0">
                    <i class="fas fa-address-book me-2"></i>Contact Information
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-12 mb-3">
                        <strong>Full Name:</strong> {{ member.full_name }}
                    </div>
                    {% if member.email %}
                    <div class="col-12 mb-3">
                        <strong>Email:</strong> 
                        <a href="mailto:{{ member.email }}">{{ member.email }}</a>
                    </div>
                    {% endif %}
                    {% if member.mobile_phone %}
                    <div class="col-12 mb-3">
                        <strong>Mobile:</strong> 
                        <a href="tel:{{ member.mobile_phone }}">{{ member.mobile_phone }}</a>
                    </div>
                    {% endif %}
                    {% if member.home_phone %}
                    <div class="col-12 mb-3">
                        <strong>Home Phone:</strong> 
                        <a href="tel:{{ member.home_phone }}">{{ member.home_phone }}</a>
                    </div>
                    {% endif %}
                    {% if member.work_phone %}
                    <div class="col-12 mb-3">
                        <strong>Work Phone:</strong> 
                        <a href="tel:{{ member.work_phone }}">{{ member.work_phone }}</a>
                    </div>
                    {% endif %}
                    {% if member.address1 %}
                    <div class="col-12 mb-3">
                        <strong>Address:</strong><br>
                        {{ member.address1 }}<br>
                        {% if member.address2 %}{{ member.address2 }}<br>{% endif %}
                        {{ member.city or '' }}, {{ member.state or '' }} {{ member.zip_code or '' }}
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- Personal Information -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header bg-purple text-white">
                <h5 class="mb-0">
                    <i class="fas fa-user me-2"></i>Personal Information
                </h5>
            </div>
            <div class="card-body">
                {% if member.date_of_birth %}
                <div class="mb-3">
                    <strong>Date of Birth:</strong> {{ member.date_of_birth }}
                </div>
                {% endif %}
                {% if member.gender %}
                <div class="mb-3">
                    <strong>Gender:</strong> {{ member.gender }}
                </div>
                {% endif %}
                {% if member.emergency_contact_name %}
                <div class="mb-3">
                    <strong>Emergency Contact:</strong> {{ member.emergency_contact_name }}
                    {% if member.emergency_contact_phone %}
                    <br><small class="text-muted">{{ member.emergency_contact_phone }}</small>
                    {% endif %}
                </div>
                {% endif %}
                {% if member.preferred_contact_method %}
                <div class="mb-3">
                    <strong>Preferred Contact:</strong> {{ member.preferred_contact_method }}
                </div>
                {% endif %}
                {% if member.referral_source %}
                <div class="mb-3">
                    <strong>Referral Source:</strong> {{ member.referral_source }}
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Agreement Information -->
{% if member.agreement_id %}
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header bg-purple text-white">
                <h5 class="mb-0">
                    <i class="fas fa-file-contract me-2"></i>Agreement Information
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <strong>Agreement ID:</strong> {{ member.agreement_id }}
                    </div>
                    {% if member.agreement_status %}
                    <div class="col-md-4 mb-3">
                        <strong>Status:</strong> 
                        <span class="badge bg-success">{{ member.agreement_status }}</span>
                    </div>
                    {% endif %}
                    {% if member.agreement_type %}
                    <div class="col-md-4 mb-3">
                        <strong>Type:</strong> {{ member.agreement_type }}
                    </div>
                    {% endif %}
                    {% if member.start_date %}
                    <div class="col-md-4 mb-3">
                        <strong>Start Date:</strong> {{ member.start_date }}
                    </div>
                    {% endif %}
                    {% if member.end_date %}
                    <div class="col-md-4 mb-3">
                        <strong>End Date:</strong> {{ member.end_date }}
                    </div>
                    {% endif %}
                    {% if member.monthly_amount %}
                    <div class="col-md-4 mb-3">
                        <strong>Monthly Amount:</strong> ${{ member.monthly_amount }}
                    </div>
                    {% endif %}
                    {% if member.billing_frequency %}
                    <div class="col-md-4 mb-3">
                        <strong>Billing Frequency:</strong> {{ member.billing_frequency }}
                    </div>
                    {% endif %}
                    {% if member.next_billing_date %}
                    <div class="col-md-4 mb-3">
                        <strong>Next Billing:</strong> {{ member.next_billing_date }}
                    </div>
                    {% endif %}
                    {% if member.auto_renew %}
                    <div class="col-md-4 mb-3">
                        <strong>Auto Renew:</strong> 
                        <span class="badge bg-{{ 'success' if member.auto_renew == 'true' else 'warning' }}">
                            {{ 'Yes' if member.auto_renew == 'true' else 'No' }}
                        </span>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Payment Information -->
{% if member.payment_token %}
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header bg-purple text-white">
                <h5 class="mb-0">
                    <i class="fas fa-credit-card me-2"></i>Payment Information
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    {% if member.card_type %}
                    <div class="col-md-3 mb-3">
                        <strong>Card Type:</strong> {{ member.card_type }}
                    </div>
                    {% endif %}
                    {% if member.card_last_four %}
                    <div class="col-md-3 mb-3">
                        <strong>Last 4 Digits:</strong> ���� {{ member.card_last_four }}
                    </div>
                    {% endif %}
                    {% if member.card_exp_month and member.card_exp_year %}
                    <div class="col-md-3 mb-3">
                        <strong>Expiration:</strong> {{ member.card_exp_month }}/{{ member.card_exp_year }}
                    </div>
                    {% endif %}
                    {% if member.billing_name %}
                    <div class="col-md-3 mb-3">
                        <strong>Billing Name:</strong> {{ member.billing_name }}
                    </div>
                    {% endif %}
                    {% if member.billing_address1 %}
                    <div class="col-12 mb-3">
                        <strong>Billing Address:</strong><br>
                        {{ member.billing_address1 }}<br>
                        {% if member.billing_address2 %}{{ member.billing_address2 }}<br>{% endif %}
                        {{ member.billing_city or '' }}, {{ member.billing_state or '' }} {{ member.billing_zip_code or '' }}
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Home Club Information -->
{% if member.home_club_name %}
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header bg-purple text-white">
                <h5 class="mb-0">
                    <i class="fas fa-home me-2"></i>Home Club Information
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <strong>Club Name:</strong> {{ member.home_club_name }}
                    </div>
                    {% if member.home_club_id %}
                    <div class="col-md-6 mb-3">
                        <strong>Club ID:</strong> {{ member.home_club_id }}
                    </div>
                    {% endif %}
                    {% if member.home_club_phone %}
                    <div class="col-md-6 mb-3">
                        <strong>Club Phone:</strong> 
                        <a href="tel:{{ member.home_club_phone }}">{{ member.home_club_phone }}</a>
                    </div>
                    {% endif %}
                    {% if member.home_club_address1 %}
                    <div class="col-12 mb-3">
                        <strong>Club Address:</strong><br>
                        {{ member.home_club_address1 }}<br>
                        {% if member.home_club_address2 %}{{ member.home_club_address2 }}<br>{% endif %}
                        {{ member.home_club_city or '' }}, {{ member.home_club_state or '' }} {{ member.home_club_zip_code or '' }}
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Action Buttons -->
<div class="row mt-4">
    <div class="col-12 text-center">
        <a href="/member/{{ member.id }}/edit" class="btn btn-purple me-2">
            <i class="fas fa-edit me-2"></i>Edit Member
        </a>
        <button class="btn btn-outline-purple me-2" data-bs-toggle="modal" data-bs-target="#messageModal">
            <i class="fas fa-envelope me-2"></i>Send Message
        </button>
        <a href="/member/{{ member.id }}/agreements" class="btn btn-outline-purple">
            <i class="fas fa-file-contract me-2"></i>View All Agreements
        </a>
    </div>
</div>

<!-- Message Modal -->
<div class="modal fade" id="messageModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Send Message to {{ member.full_name }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Message Type</label>
                        <select class="form-select" name="message_type">
                            <option value="email">Email</option>
                            <option value="sms">SMS</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="messageSubject" class="form-label">Subject</label>
                        <input type="text" class="form-control" name="subject" id="messageSubject" required>
                    </div>
                    <div class="mb-3">
                        <label for="messageContent" class="form-label">Message</label>
                        <textarea class="form-control" name="message" rows="5" id="messageContent" required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-purple">Send Message</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}